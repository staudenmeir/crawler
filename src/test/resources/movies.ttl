@prefix :           <crawler://predicate/> .
@prefix type:       <crawler://type/> .
@prefix top:        <http://www.imdb.com/chart/top> .
@prefix bottom:     <http://www.imdb.com/chart/bottom> .
@prefix page:       <http://www.imdb.com/page/> .
@prefix item:       <http://www.imdb.com/item/> .
@prefix movie:      <http://www.imdb.com/property/movie/> .
@prefix director:   <http://www.imdb.com/property/director/> .
@prefix actor:      <http://www.imdb.com/property/actor/> .

_:
    :section    top: ;
    :section    bottom: .

top:
    :page       page:movies .

bottom:
    :page       page:movies .

page:movies
    :type       type:links ;
    :path       "//table[@class='chart full-width']//a[@title]" ;
    :target     page:movie .

page:movie
    :type       type:item ;
    :item       item:movie ;
    :sub        page:directors ;
    :sub        page:actors ;
    :param      "pf_rd_m" ;
    :param      "pf_rd_p" ;
    :param      "pf_rd_r" ;
    :param      "pf_rd_s" ;
    :param      "pf_rd_t" ;
    :param      "pf_rd_i" ;
    :param      "ref_" .

page:directors
    :type       type:items ;
    :item       item:director ;
    :param      "ref_" .

page:actors
    :type       type:items ;
    :item       item:actor ;
    :param      "ref_" .

item:movie
    :path       "//div[@id='title-overview-widget']" ;
    :property   movie:label ;
    :property   movie:year ;
    :property   movie:duration ;
    :property   movie:rating ;
    :property   movie:description ;
    :property   movie:poster .

item:director
    :path       ".//div[@itemprop='director']/a" ;
    :id         "." ;
    :property   director:label .

item:actor
    :path       ".//div[@itemprop='actors']/a" ;
    :id         "." ;
    :property   actor:label .

movie:label
    :path       ".//h1/span" .

movie:year
    :path       ".//h1//a[starts-with(@href, '/year/')]" ;
    :type       xsd:int .

movie:duration
    :path       ".//time[@itemprop='duration']" ;
    :optional   true ;
    :attribute  "datetime" ;
    :type       xsd:duration .

movie:rating
    :path       ".//span[@itemprop='ratingValue']" ;
    :replace [
        :old    "," ;
        :new    "."
    ] ;
    :type       xsd:decimal .

movie:description
    :path       ".//p[@itemprop='description']" .

movie:poster
    :path       ".//img[@itemprop='image']" ;
    :optional   true ;
    :attribute  "src" ;
    :type       xsd:anyURI .

director:label
    :path       "./span" .

actor:label
    :path       "./span" .